# 🏙️ Smart City - Обновление дизайна и функционала

## 📋 Описание изменений

Проведено полное обновление приложения Smart City для города **Жезказган** с новым дизайном, функциональностью и улучшенным пользовательским интерфейсом.

---

## 🎨 1. Обновлено: Дизайн и шрифты

### Новый дизайн система (UI/design.dart):
- **Шрифт**: `Inter` (вместо `Poppins`) - более современный и четкий
- **Цветовая схема**:
  - Primary: `#6337EF`
  - Semantic colors: Success, Warning, Error, Info
  - Alert severity colors: Critical (красный), High (оранжевый), Medium (желтый), Low (зеленый)
  
### Новые компоненты:
- `PrimaryButton` - основная кнопка
- `SecondaryButton` - вторичная кнопка
- `AlertBadge` - значок-статус
- `SearchTextField` - поле поиска с очисткой
- Улучшенная `CardContainer` с тенями

### Цвета и промежутки:
```dart
AppColors:
  - primary / primaryLight / primaryDark
  - bg / surface / surfaceSecondary
  - textPrimary / textSecondary / textTertiary / textHint
  - success / warning / error / info
  - Для алертов: criticalRed, highOrange, mediumYellow, lowGreen

Gaps: xs, s, m, l, xl, xxl
```

---

## 2️⃣ Новые модели данных

### Alert (models/alert.dart)
```dart
class Alert {
  final String id;
  final String title;
  final String description;
  final String category; // 'storm', 'weather', 'transport', 'utilities', 'emergency'
  final AlertSeverity severity; // critical, high, medium, low
  final DateTime createdAt;
  final DateTime? expiresAt;
  final String? location;
  final bool read;
}
```

### UserSession (models/user_session.dart)
```dart
class UserSession {
  final String id;
  final String deviceName;
  final String deviceType; // 'phone', 'tablet', 'web'
  final String platform; // 'iOS', 'Android', 'Web'
  final String ipAddress;
  final DateTime loginTime;
  final DateTime? lastActivityTime;
  final bool isCurrentSession;
}
```

### User (models/user.dart)
```dart
class User {
  final String id;
  final String firstName;
  final String lastName;
  final String email;
  final String phoneNumber;
  final String? avatarUrl;
  final DateTime createdAt;
  final String city; // 'Almaty', 'Zhezkazgan', etc.
}
```

### NotificationSettings (models/notification_settings.dart)
```dart
class NotificationSettings {
  // Типы уведомлений
  final bool stormAlerts;
  final bool weatherAlerts;
  final bool transportAlerts;
  final bool utilitiesAlerts;
  final bool emergencyAlerts;
  
  // Каналы получения
  final bool emailNotifications;
  final bool pushNotifications;
  final bool smsNotifications;
}
```

---

## 🏘️ 3. Мок-данные обновлены

- **Город**: Жезказган (49.3233°N, 67.7602°E)
- **Текущий пользователь**: Райхан Айтжанова
- **Добавлены**:
  - 6 оповещений разных категорий и уровней серьезности
  - 3 активные сессии пользователя
  - Настройки уведомлений
  - Обновленные посты и места с на русском языке

### Категории оповещений:
- 🌪️ **Storm** - Штормовые предупреждения
- 🌦️ **Weather** - Прогнозы погоды
- 🚌 **Transport** - Информация о транспорте
- 🔧 **Utilities** - Коммунальные уведомления
- 🚨 **Emergency** - Экстренные сообщения

---

## 📱 4. Экран Home (обновлен)

**Функции:**
- 🔍 **Поиск новостей** - поиск по названию и содержимому
- 📰 Отображение новостей с изображениями
- 💾 Сохранение избранных новостей
- ⏰ Форматированная дата публикации (Сегодня, Вчера, или дата)
- Переход к полной новости

**Экран:**
```
┌─────────────────────────┐
│      Главная            │  🔔
├─────────────────────────┤
│ 🔍 Поиск новостей...    │
├─────────────────────────┤
│    НОВОСТИ              │
│ ┌─────────────────────┐ │
│ │ [Изображение]       │ │
│ │ Марафон города      │ ❤️│
│ │ Присоединяйтесь...  │ │
│ │ Сегодня  Читать →   │ │
│ └─────────────────────┘ │
│ ┌─────────────────────┐ │
│ │ Новые развлекатель  │ ❤️│
│ │ центры открыты...   │ │
│ │ Вчера   Читать →    │ │
│ └─────────────────────┘ │
```

---

## 🚨 5. Экран Alerts (новый) - **Оповещения**

**Функции:**
- 🔍 **Поиск** оповещений по названию
- 🏷️ **Фильтр по категориям** (Все, Штормовые, Погода, Транспорт, Коммунальные, Экстренные)
- ⚠️ **Фильтр по серьезности** (Критичные, Высокие, Средние, Низкие)
- 📍 Отображение локации
- ⏰ Форматированное время (только что, 5 мин назад, 2 ч назад и т.д.)
- 🎨 Цветовая кодировка по серьезности

**Экран:**
```
┌─────────────────────────────┐
│      ОПОВЕЩЕНИЯ             │
├─────────────────────────────┤
│ 🔍 Поиск оповещений...      │
├─────────────────────────────┤
│ [Все] [Штормовые] [Погода]  │
│ [Транспорт] [Коммунальные]  │
│                             │
│ [Критичные] [Высокие]       │
│ [Средние] [Низкие]          │
├─────────────────────────────┤
│ ⛈️  Штормовое предупреждение│
│ [КРИТИЧНО]                  │
│ Ожидается сильный ветер...  │
│ 📍 Жезказган   только что   │
│                             │
│ 🏠 Проблема с водоснабжением│
│ [ВЫСОКИЙ]                   │
│ В Советском районе...       │
│ 📍 Советский район  2 ч назад│
│                             │
│ 🚌 Изменение маршрутов      │
│ [СРЕДНИЙ]                   │
│ Маршруты 5 и 12 изменены... │
│ 📍 Жезказган   1 дн назад   │
```

---

## ⚙️ 6. Экран Settings (новый) - **Настройки** (Bottom Navigation)

**Структура:** PageView с 5 вкладками + BottomNavigationBar

### Вкладка 1: 👤 Профиль
- Большой аватар пользователя
- ФИО, Email, Номер телефона, Город
- Возможность редактирования каждого поля

```
┌──────────────────────────┐
│   ПРОФИЛЬ                │
├──────────────────────────┤
│        👤 (50)           │
│  Райхан Айтжанова        │
│  aitraihan@gmail.com     │
│  +7 (701) 234-56-78      │
├──────────────────────────┤
│ ИНФОРМАЦИЯ ПРОФИЛЯ       │
│ ┌────────────────────┐   │
│ │👤 Имя             │   │
│ │   Райхан      ✏️   │   │
│ └────────────────────┘   │
│ ┌────────────────────┐   │
│ │👤 Фамилия         │   │
│ │   Айтжанова   ✏️   │   │
│ └────────────────────┘   │
│ ... (email, телефон)     │
```

### Вкладка 2: 🔒 Безопасность
- **Пароль приложения**: Toggle + кнопка "Изменить пароль"
  - Диалог с двумя полями (пароль + подтверждение)
- **Учетные данные**: Обновить Email и пароль

```
┌──────────────────────────┐
│   БЕЗОПАСНОСТЬ           │
├──────────────────────────┤
│ БЕЗОПАСНОСТЬ ПРИЛОЖЕНИЯ  │
│ ┌────────────────────┐   │
│ │ Пароль приложения  │   │
│ │ Установить пароль │ ⊘ ⊚│
│ └────────────────────┘   │
│                          │
│ [Изменить пароль прилож]│
├──────────────────────────┤
│ УЧЕТНЫЕ ДАННЫЕ           │
│ ┌────────────────────┐   │
│ │ 📧 Email           │   │
│ │ [...]              │   │
│ │ 🔐 Пароль         │   │
│ │ [••••••••]         │   │
│ │                    │   │
│ │ [Сохранить измене] │   │
│ └────────────────────┘   │
```

### Вкладка 3: 🔔 Уведомления
- **Типы уведомлений** (Toggle):
  - Штормовые предупреждения
  - Информация о погоде
  - Информация о транспорте
  - Коммунальные уведомления
  - Экстренные сообщения

- **Каналы получения** (Toggle):
  - Push-уведомления
  - Email-уведомления
  - SMS-уведомления

```
┌──────────────────────────┐
│   УВЕДОМЛЕНИЯ            │
├──────────────────────────┤
│ ТИП УВЕДОМЛЕНИЙ          │
│ ┌────────────────────┐   │
│ │ ⛈️  Штормовые      │   │
│ │ Получайте... │ ⊚   │   │
│ └────────────────────┘   │
│ ┌────────────────────┐   │
│ │ 🌦️  Информация     │   │
│ │ Получайте... │ ⊚   │   │
│ └────────────────────┘   │
│ ... (транспорт, коммун)  │
├──────────────────────────┤
│ КАНАЛЫ ПОЛУЧЕНИЯ         │
│ ┌────────────────────┐   │
│ │ 📲 Push-уведомл.   │   │
│ │ Получайте... │ ⊚   │   │
│ └────────────────────┘   │
│ ┌────────────────────┐   │
│ │ 📧 Email           │   │
│ │ Получайте... │ ⊚   │   │
│ └────────────────────┘   │
```

### Вкладка 4: 🌍 Язык
- Выбор языка: Русский 🇷🇺, Қазақша 🇰🇿, English 🇬🇧
- Активный язык выделен с checkmark

```
┌──────────────────────────┐
│   ЯЗЫК                   │
├──────────────────────────┤
│ ВЫБЕРИТЕ ЯЗЫК            │
│ ┌────────────────────┐   │
│ │🇷🇺 Русский    ✓   │◄─ активный
│ └────────────────────┘   │
│ ┌────────────────────┐   │
│ │🇰🇿 Қазақша        │   │
│ └────────────────────┘   │
│ ┌────────────────────┐   │
│ │🇬🇧 English        │   │
│ └────────────────────┘   │
```

### Вкладка 5: 📱 Сессии
- Активные сессии с информацией:
  - Иконка устройства (📱 телефон, 💻 компьютер)
  - Название устройства
  - ОС (iOS, Android, Web)
  - IP адрес
  - Время входа
  - Время последней активности
  - Кнопка "Завершить сессию" (если не текущая)
  - Статус "Текущая" для активной сессии

```
┌──────────────────────────┐
│   АКТИВНЫЕ СЕССИИ        │
├──────────────────────────┤
│ УСТРОЙСТВА С ВХОДОМ      │
│ ┌────────────────────┐   │
│ │ 📱 iPhone 14 Pro   │   │
│ │ iOS                │   │
│ │ 192.168.1.100      │   │
│ │ [Текущая]          │   │
│ │                    │   │
│ │ Вход: только что   │   │
│ │ Активность: 5 мин  │   │
│ └────────────────────┘   │
│                          │
│ ┌────────────────────┐   │
│ │ 📱 Samsung Galaxy  │   │
│ │ Android            │   │
│ │ 192.168.1.101      │   │
│ │                    │   │
│ │ Вход: 1 дн назад   │   │
│ │ Активность: 12 ч н │   │
│ │                    │   │
│ │ [Завершить сессию] │   │
│ └────────────────────┘   │
```

---

## 📊 7. Обновлено: Навигация (Bottom Navigation Bar)

**Было:** 3 вкладки (Home, Map, Profile)
**Стало:** 4 вкладки (Home, Map, Alerts, Profile)

```
┌─────┬─────┬──────┬─────────┐
│ 🏠  │ 🗺️  │  🚨  │   👤    │
│Home │Map  │Alerts│ Profile │
└─────┴─────┴──────┴─────────┘
```

---

## 🎯 8. Обновленные мок-данные

### mockCurrentUser
```dart
User(
  id: 'u1',
  firstName: 'Райхан',
  lastName: 'Айтжанова',
  email: 'aitraihan@gmail.com',
  phoneNumber: '+7 (701) 234-56-78',
  city: 'Жезказган',
  createdAt: DateTime.now().subtract(const Duration(days: 365)),
)
```

### mockAlerts (6 оповещений)
- Штормовое предупреждение (Критичное)
- Проблема с водоснабжением (Высокое)
- Изменение маршрутов транспорта (Среднее)
- Информация о температуре (Среднее)
- Перебой в подаче газа (Высокое)
- Экстренное ДТП (Критичное)

### mockUserSessions (3 сессии)
- iPhone 14 Pro (iOS) - Текущая сессия
- Samsung Galaxy A52 (Android)
- MacBook Pro (Web)

### mockNotificationSettings
- Все типы уведомлений включены
- Push и Email включены
- SMS отключены

### mockPlaces (обновлено на Жезказган)
- Международный аэропорт Жезказган
- Центральный вокзал

---

## 🔧 9. AppState (обновлено)

Добавлены методы:
```dart
Future<void> setAppPassword(String password)
Future<void> setNotificationSettings(NotificationSettings settings)
Future<bool> verifyAppPassword(String password)
```

---

## 📁 Структура файлов

```
lib/
├── ui/
│   └── design.dart (ОБНОВЛЕНО - новые компоненты и цвета)
├── models/
│   ├── post.dart
│   ├── place.dart
│   ├── schedule_item.dart
│   ├── alert.dart (НОВОЕ)
│   ├── user.dart (НОВОЕ)
│   ├── user_session.dart (НОВОЕ)
│   └── notification_settings.dart (НОВОЕ)
├── screens/
│   ├── home_screen.dart (ОБНОВЛЕНО - добавлен поиск)
│   ├── map_screen.dart
│   ├── profile_screen.dart
│   ├── alerts_screen.dart (НОВОЕ - 4-я вкладка)
│   ├── settings_screen.dart (НОВОЕ - внутри профиля)
│   ├── post_detail_screen.dart
│   └── place_detail_screen.dart
├── data/
│   └── mock.dart (ОБНОВЛЕНО - новые моки)
├── state/
│   └── app_state.dart (ОБНОВЛЕНО - новые методы)
└── routes.dart (ОБНОВЛЕНО - 4 вкладки + маршруты)
```

---

## 🚀 Как использовать

### Запуск приложения:
```bash
flutter pub get
flutter run
```

### Навигация:
- **Home** 🏠 - Новости с поиском
- **Map** 🗺️ - Карта мест (существующая)
- **Alerts** 🚨 - Оповещения с поиском и фильтрацией
- **Profile** 👤 - Настройки (подсвечивается в обновленном Settings)

### Settings Navigation (5 вкладок):
1. 👤 Профиль - редактирование ФИО и контактов
2. 🔒 Безопасность - пароль приложения и учетные данные
3. 🔔 Уведомления - настройка типов и каналов
4. 🌍 Язык - выбор языка приложения
5. 📱 Сессии - просмотр активных устройств

---

## 📝 Примечания

- ✅ Все данные используют mock (готовы для интеграции с backend)
- ✅ Поддержка 3 языков: Русский, Казахский, Английский
- ✅ Material Design 3 компоненты
- ✅ Responsive дизайн
- ✅ Цветовая кодировка по серьезности оповещений
- ✅ Современный шрифт Inter
- ✅ Удобные фильтры и поиск

**Готово для визуальной демонстрации на фронте! 🎉**
